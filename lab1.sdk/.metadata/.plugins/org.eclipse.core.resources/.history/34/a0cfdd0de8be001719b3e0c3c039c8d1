#include "test_run.h"
#include <stdlib.h>


void print_on_7seg(u8 data)
{
	u32 *data_ptr = (u32*) BCD_BASE_ADDR;
	*(data_ptr + 0) = data;
}

void test_hw()
{
	u32 *data_ptr = (u32*) BCD_BASE_ADDR;
	u32 data_read = 0;
	*(data_ptr + 0) = 3;
	data_read = *(data_ptr + 0);
	xil_printf("result from reg0: %d \r\n", data_read);
	xil_printf("result from LSB reg0: %d \r\n", (data_read & 0xf));
	*(data_ptr + 1) = 100;
	data_read = *(data_ptr + 1);
	xil_printf("result from reg 1: %d \r\n", data_read);
	*(data_ptr + 2) = 2;
	data_read = *(data_ptr + 2);
	xil_printf("result from reg 2: %d \r\n", data_read);
	data_read = *(data_ptr + 3);
	xil_printf("result from reg 3: %d \r\n", data_read);
}

int main()
{
	u32 *data_ptr = (u32*) BCD_BASE_ADDR;
	u32 data_read = 0;
	xil_printf("System Initialized \r\n");
	u8 tries = 9;
	u8 number, number_guess;
	xil_printf("Welcome to the Guess the Number game \r\n");
	initialize_uart(UARTLITE_DEVICE_ID);
	setup_timer(TIMER_DEVICE_ID,  0x0);
	u32 time_elapsed = 0;
	start_timer(0x0);
	xil_printf("Tell me a number, this is a free trial \r\n");
	number_guess = reveive_ascii_to_number();
	time_elapsed = stop_timer(0x0);
	xil_printf("time elapsed %d \r\n", time_elapsed);
	srand((unsigned)(time_elapsed & 0xf));
	xil_printf("You entered %d \r\n", number_guess);
	xil_printf("Good, Good -_- you have a way with number\r\n");
	// enter the seed for random function.
	xil_printf("lets the game start then \r\n");
	xil_printf("You have nine tries \r\n");
	print_on_7seg(tries);
	xil_printf("Try out your luck today, this is real now *_* \r\n");
	number_guess = reveive_ascii_to_number();
	print_on_7seg(tries);
    return 0;
}


